# RealtyChatBot
Чатбот для оформления объявлений по шаблону с последующей их публикацией в тематический Телеграм-канал.

## Основные функции
1. Создание объявления по шаблону, заданному в коде бота.
2. Редактирование заполненного объявления перед его отправкой в тематический чат.
3. Отправка объявления в тематический чат и сохранение его в базе данных на сервере, на котором запущен бот.
4. Обновление ранее отправленного объявления.

## Описание структуры объявления
Объявление, отправляемое в тематический чат, состоит из нескольких отдельных сообщений следующего содержания:
1. Заголовок с указанием номера объявления (всегда).
2. Основная текстовая часть из нескольких строк (всегда).
3. Дополнительные сообщения с текстом, фотографиями, аудио-видео-файлами, документами или геопозицией. Эти сообщения необязательны и будут присутствовать, если пользователь отправил перечисленную информациию при создании или редактировании объявления. 

## Порядок использования
При самом первом обращении к боту необходимо вручную набрать и отправить команду  */start*. В ответ на нее бот отправляет пользователю приветственное сообщение и клавиатуру с основными командами. (На десктопной версии Telegram эта клавиатуру имеет свойство сворачиваться в процессе использования бота). В дальнейшем использование функций бота осуществляется при помощи команд, которые будут отображаются на клавиатуре, созданной ботом (эти команды можно также ввести вручную), и при помощи отправляемых ботом кнопок.

### Основные команды
1. `/create` или `/Создать_объявление` - запускает диалог для заполнения бланка объявления;
2. `/renew` или `/Обновить_объявление`- запускает процесс для поиска и редактирования ранее созданного объявления;
3. `/Прекратить` - останавливает текущий процесс создания или редактирования;
4. `/break` или `/Завершить_все` - останавливает все запущенные пользователем процессы (стек команд полностью очищается);
5. `/help` или `/Подсказка` - выводит информацию о работе с ботом.

При вводе команд вручную важно соблюдать регистр первого символа и не пропускать знак подчеркивания "_" там, где он есть.

###  Описание процесса создания объявления
1. Запустить процесс ручным вводом команды `/create` или нажатием на кнопку с названием команды `/Создать_объявление`.
2. Отправить запрашиваемую информацию в процессе диалога с ботом. В текущей реализации на каждом шаге выполняется проверка допустимости отправленных данных. Например, если ожидается ввод текста, то в ответ на направленную фотографию бот укажет на ошибку типа данных. Если вместо числа для конкретного пункта объявления будет направлен текст, бот также сообщит об этом.
3. Если на каком-то шаге ввод информации не является обязательным, бот пришлет кнопку "Пропустить" для возможности пропуска ввода данных.
4. Когда все предусмотренные диалогом вопросы будут заданы, бот пришлет макет объявления и две кнопки для выбора действия: "Разместить" и "Редактировать". 
При выборе кнопки "Разместить" объявление будет направлено в тематический чат и сохранено в базе данных, а пользователю вернется сообщение с номером объявления, кодом на случай возникновения необходимости в редактировании объявления и кнопкой для запуска редактирования данного объявления ("Обновить_объявление"). 
При выборе кнопки "Редактировать" запустится процесс редактирования текущего объявления. Он описан далее.

###  Описание процесса редактирования объявления
1. Запустить процесс одним из способов:
- вручную ввести команду `/renew` или нажать на кнопку с названием команды `/Обновить_объявление`, а затем ввести код для доступа к редактированию, который был получен при создании объявления;
- нажать на кнопку, которая была создана в конце процесса создания объявления.
2. Редактировать объявления может автор объявления, а также другой пользователь, которому даны права модератора или админа. В текущей версии бота не реализован интерфейс для назначения пользователям этих прав, но это можно выполнить путем ручного внесения информации в базу данных (таблица БД 'tg_users', в поле 'is_admin', 'is_moderator' записать значение True).
